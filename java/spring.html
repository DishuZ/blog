<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前注 | Zenbu Space</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/assets/img/favicon.ico">
    <meta name="description" content="属于Zenbu的个人博客，持续记录对技术的讲解和梳理学习的知识">
    
    <link rel="preload" href="/blog/assets/css/0.styles.1ccea0a9.css" as="style"><link rel="preload" href="/blog/assets/js/app.04d1c14b.js" as="script"><link rel="preload" href="/blog/assets/js/2.37055818.js" as="script"><link rel="preload" href="/blog/assets/js/33.7d1040a5.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.8c28c3ea.js"><link rel="prefetch" href="/blog/assets/js/11.89a29c07.js"><link rel="prefetch" href="/blog/assets/js/12.13ede5f4.js"><link rel="prefetch" href="/blog/assets/js/13.d5d0de46.js"><link rel="prefetch" href="/blog/assets/js/14.1e04eecd.js"><link rel="prefetch" href="/blog/assets/js/15.3002afa4.js"><link rel="prefetch" href="/blog/assets/js/16.4c1241e8.js"><link rel="prefetch" href="/blog/assets/js/17.0be426b3.js"><link rel="prefetch" href="/blog/assets/js/18.93db46e0.js"><link rel="prefetch" href="/blog/assets/js/19.741f53ac.js"><link rel="prefetch" href="/blog/assets/js/20.1503f3f0.js"><link rel="prefetch" href="/blog/assets/js/21.505cb8eb.js"><link rel="prefetch" href="/blog/assets/js/22.f76a715d.js"><link rel="prefetch" href="/blog/assets/js/23.5ffa7b6d.js"><link rel="prefetch" href="/blog/assets/js/24.12e44cd3.js"><link rel="prefetch" href="/blog/assets/js/25.54e00b4c.js"><link rel="prefetch" href="/blog/assets/js/26.9fdda262.js"><link rel="prefetch" href="/blog/assets/js/27.c1a06b9a.js"><link rel="prefetch" href="/blog/assets/js/28.37711cbc.js"><link rel="prefetch" href="/blog/assets/js/29.9594dc2d.js"><link rel="prefetch" href="/blog/assets/js/3.22df5610.js"><link rel="prefetch" href="/blog/assets/js/30.03c38711.js"><link rel="prefetch" href="/blog/assets/js/31.c9e6a769.js"><link rel="prefetch" href="/blog/assets/js/32.ec8f742a.js"><link rel="prefetch" href="/blog/assets/js/34.39155ca1.js"><link rel="prefetch" href="/blog/assets/js/35.dd26ac2a.js"><link rel="prefetch" href="/blog/assets/js/36.75451d46.js"><link rel="prefetch" href="/blog/assets/js/37.67f68d98.js"><link rel="prefetch" href="/blog/assets/js/38.a2be9b35.js"><link rel="prefetch" href="/blog/assets/js/39.ad81ed6f.js"><link rel="prefetch" href="/blog/assets/js/4.f766401c.js"><link rel="prefetch" href="/blog/assets/js/40.25a142c4.js"><link rel="prefetch" href="/blog/assets/js/41.f23d29a8.js"><link rel="prefetch" href="/blog/assets/js/42.b65084f3.js"><link rel="prefetch" href="/blog/assets/js/43.4984eac1.js"><link rel="prefetch" href="/blog/assets/js/44.bd527c0d.js"><link rel="prefetch" href="/blog/assets/js/45.37c2094d.js"><link rel="prefetch" href="/blog/assets/js/46.34e7bce6.js"><link rel="prefetch" href="/blog/assets/js/47.ddb1f1b5.js"><link rel="prefetch" href="/blog/assets/js/48.d8b50953.js"><link rel="prefetch" href="/blog/assets/js/5.b9444ef6.js"><link rel="prefetch" href="/blog/assets/js/6.bc5ed194.js"><link rel="prefetch" href="/blog/assets/js/7.17928ded.js"><link rel="prefetch" href="/blog/assets/js/8.bf4d5cdf.js"><link rel="prefetch" href="/blog/assets/js/9.023c1000.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.1ccea0a9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container tech-page"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/assets/img/logo.png" alt="Zenbu Space" class="logo"> <span class="site-name can-hide">Zenbu Space</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/about.html" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/blog/cpp/" class="nav-link">
  C++
</a></div><div class="nav-item"><a href="/blog/java/" class="nav-link router-link-active">
  Java
</a></div><div class="nav-item"><a href="/blog/mark_md.html" class="nav-link">
  Markdown
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Liberary Menu" class="dropdown-title"><span class="title">Liberary</span> <span class="arrow down"></span></button> <button type="button" aria-label="Liberary Menu" class="mobile-dropdown-title"><span class="title">Liberary</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/proletarian/" class="nav-link">
  阅读
</a></li><li class="dropdown-item"><!----> <a href="/blog/resource.html" class="nav-link">
  资源
</a></li></ul></div></div> <a href="https://github.com/DishuZ/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/about.html" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/blog/cpp/" class="nav-link">
  C++
</a></div><div class="nav-item"><a href="/blog/java/" class="nav-link router-link-active">
  Java
</a></div><div class="nav-item"><a href="/blog/mark_md.html" class="nav-link">
  Markdown
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Liberary Menu" class="dropdown-title"><span class="title">Liberary</span> <span class="arrow down"></span></button> <button type="button" aria-label="Liberary Menu" class="mobile-dropdown-title"><span class="title">Liberary</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/proletarian/" class="nav-link">
  阅读
</a></li><li class="dropdown-item"><!----> <a href="/blog/resource.html" class="nav-link">
  资源
</a></li></ul></div></div> <a href="https://github.com/DishuZ/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/java/" aria-current="page" class="sidebar-link">基础</a></li><li><a href="/blog/java/java_project.html" class="sidebar-link">项目</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="maven"><a href="#maven" class="header-anchor">#</a> Maven</h1> <p>Maven 的本质是一个项目管理工具，将项目开发和管理过程抽象成一个项目对象模型（POM, Project Object Model）。</p> <p>Maven 的作用：</p> <ol><li>项目构建：提供标准的、跨平台的自动化项目构建方式</li> <li>依赖管理：方便快捷的管理项目依赖的资源（jar 包），避免资源间的版本冲突问题</li> <li>统一开发结构：提供标准的、统一的项目结构</li></ol> <h2 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h2> <p>仓库：用于存储资源，包含各种 jar 包</p> <p>仓库分类：</p> <ul><li>本地仓库：自己电脑上存储资源的仓库，连接远程仓库获取资源</li> <li>远程仓库：非本机电脑上的仓库，为本地仓库提供资源
<ul><li>中央仓库： Maven 团队维护，存储所有公共资源的仓库</li> <li>私服：部门/公司范围内存储资源的仓库，从中央仓库获取资源
<ul><li>作用：
<ul><li>保存具有版权的资源，包含购买或自主研发的 jar</li> <li>一定范围内共享资源，仅对内开放，不对外共享</li></ul></li></ul></li></ul></li></ul> <p>坐标：用于描述仓库中资源的位置</p> <p>Maven 坐标主要组成</p> <ul><li><code>groupId</code> 定义当前 Maven 项目隶属组织名称（通常是域名反写，例如： org.mybatis）</li> <li><code>artifactId</code> 定义当前 Maven 项目名称（通常是模块名称，例如 CRM、SMS）</li> <li><code>version</code> 定义当前项目版本号</li> <li><code>packaging</code> 定义该项目的打包方式</li></ul> <h1 id="spring-简介"><a href="#spring-简介" class="header-anchor">#</a> Spring 简介</h1> <h2 id="spring-是什么"><a href="#spring-是什么" class="header-anchor">#</a> Spring 是什么</h2> <p>Spring 是分层的 Java SE/EE 应用 full-stack 轻量级开源架构，以 IOC (Inverse Of Control, 反转控制) 和 AOP (Aspect Oriented Programming, 面向切面编程) 为内核。提供了展现层 SpringMVC 和持久层 Spring JDBCTemplate 以及业务层事务管理等众多的企业级应用技术，还能整合开源世界众多的第三方框架和类库，逐渐成为使用最多的 JavaEE 企业应用开源框架。</p> <p>Spring 开发步骤：</p> <ol><li>导入坐标</li> <li>创建 Bean</li> <li>创建 applicationContext.xml</li> <li>在配置文件中进行配置</li> <li>创建 ApplicationContext 对象 getBean</li></ol> <p>Spring 原始注解</p> <table><thead><tr><th>注解</th> <th>说明</th></tr></thead> <tbody><tr><td><code>@Component</code></td> <td>使用在类上，用于实例化 Bean</td></tr> <tr><td><code>@Controller</code></td> <td>使用在 web 层类上，用于实例化 Bean</td></tr> <tr><td><code>@Service</code></td> <td>使用在 service 层类上，用于实例化 Bean</td></tr> <tr><td><code>@Repository</code></td> <td>使用在 dao 层类上，用于实例化 Bean</td></tr> <tr><td><code>@Autowired</code></td> <td>使用在字段上，用于根据类型依赖注入</td></tr> <tr><td><code>@Qualifier</code></td> <td>结合 <code>@Autowired</code> 一起使用，用于根据名称进行依赖注入</td></tr> <tr><td><code>@Resource</code></td> <td>相当于 <code>@Autowired</code> + <code>@Qualifier</code> ，按照名称进行注入</td></tr> <tr><td><code>@Value</code></td> <td>注入普通属性</td></tr> <tr><td><code>@Scope</code></td> <td>标注 Bean 的作用范围</td></tr> <tr><td><code>@PostConstruct</code></td> <td>使用在方法上，标注该方法是 Bean 的初始化方法</td></tr> <tr><td><code>@PreDestroy</code></td> <td>使用在方法上，标注该方法是 Bean 的销毁方法</td></tr></tbody></table> <p>Spring 新注解</p> <table><thead><tr><th>注解</th> <th>说明</th></tr></thead> <tbody><tr><td><code>@Configuration</code></td> <td>用于指定当前类是一个 Spring 配置类，当创建容器时会从该类上加载注解</td></tr> <tr><td><code>@ComponentScan</code></td> <td>用于指定 Spring 在初始化容器时要扫描的包。作用和在 Spring 的 xml 配置文件中的 <code>&lt;context:component-scan base-package=&quot;com.itheima&quot; /&gt;</code> 一样</td></tr> <tr><td><code>@Bean</code></td> <td>使用在方法上，标注将该方法的返回值存储到 Spring 容器中</td></tr> <tr><td><code>@PropertySource</code></td> <td>用于加载 <code>.properties</code> 文件中的配置</td></tr> <tr><td><code>@Import</code></td> <td>用于导入其他配置类</td></tr></tbody></table> <p>SpringMVC 相关组件：</p> <ul><li>前端控制器 <code>DispatcherServlet</code></li> <li>处理器映射器 <code>HandlerMapping</code></li> <li>处理器适配器 <code>HandlerAdapter</code></li> <li>处理器 <code>Handler</code></li> <li>视图解析器 <code>ViewReslover</code></li> <li>视图 <code>View</code></li></ul> <p>SpringMVC 开发步骤：</p> <ol><li>导入 SpringMVC 相关坐标</li> <li>配置 SpringMVC 核心控制器 DispathcerServlet</li> <li>创建 Controller 类和视图页面</li> <li>使用注解配置 Controller 类中业务方法的映射地址</li> <li>配置 SpringMVC 核心文件 spring-mvc.xml</li> <li>客户端发起请求测试</li></ol> <p>SpringMVC 执行流程</p> <ol><li>用户发送请求至前端控制器 <code>DispatcherServlet</code>.</li> <li><code>DispatcherServlet</code> 收到请求调用 <code>HandlerMapping</code> 处理器映射器。</li> <li>处理器映射器找到具体的处理器(可以根据xml配置、注解进行查找)，生成处理器对象及处理器拦截器(如果有则生成)一并返回给 <code>DispatcherServlet</code> 。</li> <li><code>DispatcherServlet</code> 调用 <code>HandlerAdapter</code> 处理器适配器。</li> <li><code>HandlerAdapter</code> 经过适配调用具体的处理器(Controller，也叫后端控制器)。</li> <li>Controller 执行完成返回 ModelAndView。</li> <li><code>HandlerAdapter</code> 将 controller 执行结果 ModelAndView 返回给 <code>DispatcherServlet</code>。</li> <li><code>DispatcherServlet</code> 将 ModelAndView 传给 ViewReslover 视图解析器。</li> <li>ViewReslover 解析后返回具体 View 。</li></ol> <h2 id="_1-4-依赖注入"><a href="#_1-4-依赖注入" class="header-anchor">#</a> 1.4 依赖注入</h2> <h3 id="_1-4-1-依赖注入的概念"><a href="#_1-4-1-依赖注入的概念" class="header-anchor">#</a> 1.4.1 依赖注入的概念</h3> <p><strong>依赖注入</strong> （Dependency Injection, DI）与 <strong>控制反转</strong> （IoC）的含义相同，只不过这两个称呼是从两个角度描述的同一个概念。</p> <p>在使用 Spring 框架之后，对象的实例不再由调用者来创建，而是由 Spring 容器来创建， Spring 容器会负责控制程序之间的关系，而不是由对用着的程序代码直接控制。这样，控制权由应用代码转移到了 Spring 容器，控制权发生了反转，这就是 Spring 的 IoC 。从 Spring 容器的角度看， Spring 容器负责将被依赖对象赋值给调用者的成员变量，这相当于为调用者注入了它依赖的实例，这就是 Spring 的 DI 。</p> <h3 id="_1-4-2-依赖注入的实现方式"><a href="#_1-4-2-依赖注入的实现方式" class="header-anchor">#</a> 1.4.2 依赖注入的实现方式</h3> <p>依赖注入的作用，就是在使用 Spring 框架创建对象时，动态地将其所依赖的对象注入 Bean 组件中，实现方式通常有两种：</p> <ol><li>属性 <code>setter</code> 方法注入：指 IoC 容器使用 <code>setter</code> 方法注入被依赖的实例。通过调用无参构造器或无参静态工厂方法实例化 Bean 后，调用该 Bean 的 <code>setter</code> 方法，即可实现基于 <code>setter</code> 方法的依赖注入。</li></ol> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token comment">// UserService.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>ioc</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// UserServiceImpl.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>ioc</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
  <span class="token comment">// 声明 UserDao 属性</span>
  <span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>
  <span class="token comment">// 添加 UserDao 属性的 setter 方法，用于实现依赖注入</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUserDao</span><span class="token punctuation">(</span><span class="token class-name">UserDao</span> userDao<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userDao <span class="token operator">=</span> userDao<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 实现接口中的方法</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userDao<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-xml line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code><span class="token comment">&lt;!-- applicationContext.xml --&gt;</span>
...
  <span class="token comment">&lt;!-- 添加一个 id 为 userService 的实例 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.itheima.ioc.UserServiceImpl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 将 id 为 userDao 的 Bean 实例注入到 userService 实例中 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userDao<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userDao<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
...
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="2"><li>构造方法注入：指 IoC 容器使用构造方法注入被依赖的实例。基于构造方法的依赖注入通过调用带参数的构造方法来实现，每个参数代表着一个依赖。</li></ol> <h1 id="spring-中的-bean"><a href="#spring-中的-bean" class="header-anchor">#</a> Spring 中的 Bean</h1> <h2 id="_2-1-bean-的配置"><a href="#_2-1-bean-的配置" class="header-anchor">#</a> 2.1 Bean 的配置</h2> <p>Spring 可以被看作是一个大型工厂，这个工厂的作用就是生产和管理 Spring 容器中的 Bean 。在使用 Spring 容器之前，需要对 Spring 的配置文件进行配置。</p> <p>Spring 容器支持 <code>XML</code> 和 <code>Properties</code> 两种格式的配置文件。以下演示 <code>xml</code> 配置：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;l.O&quot; encoding=&quot;UTF-8&quot;?&gt;</span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 

<span class="token comment">&lt;!-- 使用 id 属性定义 beanl ，其对应的实现类为 com itheima .Beanl --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beanl<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.itheima.Beanl<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 

<span class="token comment">&lt;!-- 使用口ame 属性定义 bean2 ，其对应的实现类为 com.itheima.Bean2 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bean2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.itheima.Bean2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_2-2-bean-的实例化"><a href="#_2-2-bean-的实例化" class="header-anchor">#</a> 2.2 Bean 的实例化</h2> <p>实例化 Bean 有三种方式：构造器实例化、静态工厂实例化和实例工厂实例化。</p> <h3 id="构造器实例化"><a href="#构造器实例化" class="header-anchor">#</a> 构造器实例化</h3> <h3 id="静态工厂实例化"><a href="#静态工厂实例化" class="header-anchor">#</a> 静态工厂实例化</h3> <h3 id="实例工厂实例化"><a href="#实例工厂实例化" class="header-anchor">#</a> 实例工厂实例化</h3> <h2 id="_2-4-bean-的生命周期"><a href="#_2-4-bean-的生命周期" class="header-anchor">#</a> 2.4 Bean 的生命周期</h2> <p>Spring 容器可以管理 <code>singleton</code> 作用域的 Bean 的生命周期，在此作用域下， Spring 能够精确地知道该 Bean 何时被创建，何时初始化完成以及何时被销毁。</p> <p>对于 <code>prototype</code> 作用域的 Bean , Spring 只负责创建，当容器创建了 Bean 实例后， Bean 的实例就交给客户端代码来管理， Spring 容器将不再跟踪其生命周期。每次客户端请求 <code>prototype</code> 作用域的 Bean 时， Spring 容器都会创建一个新的实例，并且不会管那些被配置成 <code>prototype</code> 作用域的 Bean 的生命周期。</p> <p>Bean 的生命周期的整个执行过程描述如下：</p> <ol><li>根据配置情况调用 Bean 构造方法或工厂方法实例化 Bean</li> <li>利用依赖注入完成 Bean 中所有属性值的配置注入</li> <li>如果 Bean 实现了 <code>BeanNameAware</code> 接口，则 Spring 调用 Bean 的 <code>setBeanName()</code> 方法传入当前 Bean 的 id 值</li> <li>如果 Bean 实现了 <code>BeanFactoryAware</code> 接口，则 Spring 调用 <code>setBeanFactory()</code> 方法传入当前工厂实例的引用</li> <li>如果 Bean 实现了 <code>ApplicationContextAware</code> 接口，则 Spring 调用 <code>setApplicationContext()</code> 方法传入当前 <code>ApplicationContext</code> 实例的引用</li> <li>如果 <code>BeanPostProcessor</code> 和 Bean 关联，则 Spring 将调用该接口的预初始化方法 <code>postProcessBeforeInitialzation()</code> 对 Bean 进行加工操作，这个非常重要， Spring 的 AOP 就是用它实现的</li> <li>如果Bean 实现了 <code>InitializingBean</code> 接口，则 Spring 将调用<code>afterPropertiesSet()</code> 方法</li> <li>如果在配置文件中通过 <code>init-method</code> 属性指定了初始化方法，则调用该初始化方法</li> <li>如果有 <code>BeanPostProcessor</code> 和 Bean 关联，则 Spring 将调用该接口的初始化方法 <code>postProcessAfterInitialization()</code> 。此时，Bean 已经可以被应用系统使用了。</li> <li>如果在 <code>&lt;bean&gt;</code> 中指定了该 Bean 的作用范围为<code>scope=&quot;singleton&quot;</code> ，则将该 Bean 放入 Spring IoC 的缓存池中，将触发 Spring 对该 Bean 的生命周期管理；如果在 <code>&lt;bean&gt;</code> 中指定了该 Bean 的作用范围为 <code>scope=&quot;prototype&quot;</code> ，则将该 Bean 交给调用者，调用者管理该 Bean 的生命周期，Spring 不再管理该Bean。</li> <li>如果 Bean 实现了 <code>DisposableBean</code> 接口，则 Spring 会调用<code>destory()</code> 方法将 Spring 中的 Bean 销毁；如果在配置文件中通过 <code>destory-method</code> 属性指定了 Bean 的销毁方法，则 Spring 将调用该方法进行销毁。</li></ol> <p>Spring Bean 提供了细致全面的生命周期过程，通过实现特定的接口或通过 <code>&lt;bean&gt;</code> 的属性设置，都可以对 Bean 的生命周期过程产生影响 我们可以随意地配置 <code>&lt;bean&gt;</code> 的属性，但是在这里 <strong>建议不要过多地使用 Bean 实现接口，因为这样会使代码和 Spring 聚合比较紧密</strong></p> <h2 id="_2-5-bean-的装配方式"><a href="#_2-5-bean-的装配方式" class="header-anchor">#</a> 2.5 Bean 的装配方式</h2> <p>Bean 的装配可以理解为依赖关系注入， Bean 的装配方式即 Bean 依赖注入的方式 Spring 容器支持多种形式的 Bean 的装配方式，如基于 XML 的装配、基于注解（Annotation）的装配和自动装配等。</p> <p>其中最常用的是基于 Annotation 的装配，下面对此进行讲解。</p> <h3 id="_2-5-1-基于-annotation-的装配"><a href="#_2-5-1-基于-annotation-的装配" class="header-anchor">#</a> 2.5.1 基于 Annotation 的装配</h3> <p>Spring 提供了对 Annotation 技术的全面支持，定义了一系列的注解，常用注解如下所示。</p> <table><thead><tr><th>注解</th> <th>说明</th></tr></thead> <tbody><tr><td><code>@Component</code></td> <td>使用在类上，表示是一个组件 Bean，用于实例化 Bean</td></tr> <tr><td><code>@Controller</code></td> <td>使用在 web 层类上，用于实例化 Bean</td></tr> <tr><td><code>@Service</code></td> <td>使用在 service 层类上，用于实例化 Bean</td></tr> <tr><td><code>@Repository</code></td> <td>使用在 dao 层类上，用于实例化 Bean</td></tr> <tr><td><code>@Autowired</code></td> <td>使用在字段上，用于根据类型依赖注入</td></tr> <tr><td><code>@Qualifier</code></td> <td>结合 <code>@Autowired</code> 一起使用，用于根据名称进行依赖注入</td></tr> <tr><td><code>@Resource</code></td> <td>相当于 <code>@Autowired</code> + <code>@Qualifier</code> ，按照名称进行注入</td></tr> <tr><td><code>@Value</code></td> <td>注入普通属性</td></tr> <tr><td><code>@Scope</code></td> <td>标注 Bean 的作用范围</td></tr> <tr><td><code>@PostConstruct</code></td> <td>使用在方法上，标注该方法是 Bean 的初始化方法</td></tr> <tr><td><code>@PreDestroy</code></td> <td>使用在方法上，标注该方法是 Bean 的销毁方法</td></tr> <tr><td>--</td> <td>--</td></tr> <tr><td><code>@Configuration</code></td> <td>用于指定当前类是一个 Spring 配置类，当创建容器时会从该类上加载注解</td></tr> <tr><td><code>@ComponentScan</code></td> <td>用于指定 Spring 在初始化容器时要扫描的包。作用和在 Spring 的 xml 配置文件中的 <code>&lt;context:component-scan base-package=&quot;com.itheima&quot; /&gt;</code> 一样</td></tr> <tr><td><code>@Bean</code></td> <td>使用在方法上，标注将该方法的返回值存储到 Spring 容器中</td></tr> <tr><td><code>@PropertySource</code></td> <td>用于加载 <code>.properties</code> 文件中的配置</td></tr> <tr><td><code>@Import</code></td> <td>用于导入其他配置类</td></tr></tbody></table> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token comment">// UserDao.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>annotation</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// UserDaoImpl.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>annotation</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Repository</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Repository</span> <span class="token punctuation">(</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDaoImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;userdao...save...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// UserService.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span></span> nnotation<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> save <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// UserServiceImpl.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>annotation</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span><span class="token string">&quot;userService&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Resource</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;userDao&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span>
  
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//调用userDao中的save方法</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;userservice.. . .save. . .&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>配置文件：</p> <div class="language-xml line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;l.O&quot; encoding=&quot;UTF-8&quot;?&gt;</span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/context<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans 
      http://www.springframework.org/schema/beans/spring-beans.xsd
      http://www.springframework.org/schema/context 
      http://www.springframework.org/schema/context/spring-context-4.3.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 

  <span class="token comment">&lt;!-- 使用 context 命名空间 通知 Spring 扫描指定包下所有 Bean ，进行注解解析 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-packaqe</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.itheima.annotation<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h1 id="spring-aop"><a href="#spring-aop" class="header-anchor">#</a> Spring AOP</h1> <h2 id="_3-1-aop-简介"><a href="#_3-1-aop-简介" class="header-anchor">#</a> 3.1 AOP 简介</h2> <p><strong>AOP</strong> 的全称是 Aspect-Oriented Programming，即 <strong>面向切面编程</strong> (也称面向方面编程)。它是面向对象编程(OOP)的一种补充，目前已成为一种比较成熟的编程方式。</p> <p><strong>AOP 采取横向抽取机制</strong> ，将分散在各个方法中的重复代码提取出来，然后在程序编译或运行时，再将这些提取出来的代码应用到需要执行的地方。这种采用横向抽取机制的方式，采用传统的 OOP 思想显然是无法办到的，因为 OOP 只能实现父子关系的纵向的重用。虽然 AOP 是一种新的编程思想，但却不是 OOP 的替代品，它只是 OOP 的延伸和补充。</p> <p>目前最流行的 AOP 框架有两个，分别为 <strong>Spring AOP</strong> 和 <strong>AspectJ</strong> . Spring AOP 使用纯 Java 实现，不需要专门的编译过程和类加载器，在运行期间通过代理方式向目标类织入增强的代码。 AspectJ 是一个基于 Java 语言的 AOP 框架，从 Spring 2.0 开始， Spring AOP 引入了对 AspectJ 的支持， AspectJ 扩展了 Java 语言，提供了一个专门的编译器，在编译时提供横向代码的织入。</p> <p>以下是关于 AOP 的一些专业术语：</p> <table><thead><tr><th>术语</th> <th>说明</th></tr></thead> <tbody><tr><td><code>Aspect</code> 切面</td> <td>切面通常是指封装的用于横向插入系统功能(如事务、日志等)的 <strong>类</strong>。该类要被 Spring 容器识别为切面，需要在配置文件中通 <code>&lt;bean&gt;</code> 元素指定</td></tr> <tr><td><code>Joinpoint</code> 连接点</td> <td>在程序执行过程中的某个阶段点，它实际上是 <strong>对象的一个操作</strong> ，例如方法的调用或异常的抛出。在 Spring AOP 中，连接点就是指方法的调用</td></tr> <tr><td><code>Pointcut</code> 切入点</td> <td>是指切面与程序流程的交叉点，即 <strong>那些需要处理的连接点。切入点指的是类或者方法名</strong> ，如某个通知要应用到所有以 add 方法中，那么所有满足这一规则的方法都是切入点</td></tr> <tr><td><code>Advice</code> 通知/增强管理</td> <td>AOP 框架在特定的切入点执行的增强处理，即<strong>在定义好的切入点处所要执行的程序代码，可以将其理解为切面类中的方法，它是切面的具体实现</strong></td></tr> <tr><td><code>Target Object</code> 目标对象</td> <td>是指所有被通知的对象，也称为 <strong>被增强对象</strong> 。如果 AOP 框架采用的是动态的 AOP 实现，那么该对象就是一个被代理对象</td></tr> <tr><td><code>Proxy</code> 代理</td> <td>将通知应用到目标对象之后，被动态创建的对象</td></tr> <tr><td><code>Weaving</code> 织入</td> <td>将切面代码插入到目标对象上，从而生成代理对象的 <strong>过程</strong></td></tr></tbody></table> <img src="../assets/images/java/切点连接点和切入点.jpg" alt="切点、连接点和切入点" class="zoom"> <h2 id="_3-2-动态代理"><a href="#_3-2-动态代理" class="header-anchor">#</a> 3.2 动态代理</h2> <p>AOP 中的代理就是由 AOP 框架动态生成的一个对象，该对象可以作为目标对象使用。 Spring 中的 AOP 代理，可以是 JDK 动态代理，也可以是 CGLIB 代理。</p> <p>下面讲讲 JDK 动态代理（Spring 中的 AOP 代理默认就是使用 JDK 动态代理的方式来实现的）。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// MyAspect.java </span>
<span class="token comment">// 在该类中定义一个模拟权限检查的方法和一个模拟记录日志的方法，这两个方法就表示切面中的通知</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>aspect</span><span class="token punctuation">;</span> 

<span class="token comment">// 切面类：可以存在多个通知 Advice (即增强的方法)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAspect</span> <span class="token punctuation">{</span> 

  <span class="token keyword">public</span> <span class="token keyword">void</span> check <span class="token class-name">Permissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; 模拟检查权限. . . &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; 模拟记录日志. . . &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// JdkProxy.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>jdk</span><span class="token punctuation">;</span> 

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>lnvocationHandler</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java</span> <span class="token class-name"><span class="token namespace">lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span>Proxy</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>aspect<span class="token punctuation">.</span></span><span class="token class-name">MyAspect</span><span class="token punctuation">;</span>

<span class="token comment">/**
  JDK 代理类
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdkProxy</span> <span class="token keyword">implements</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">{</span>
  <span class="token comment">// 声明目标类接口</span>
  <span class="token keyword">private</span> <span class="token class-name">UserDao</span> userDao<span class="token punctuation">;</span> 

  <span class="token comment">// 创建代理方法</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">createProxy</span><span class="token punctuation">(</span><span class="token class-name">UserDao</span> userDao<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userDao <span class="token operator">=</span> userDao<span class="token punctuation">;</span> 

    <span class="token comment">// 1.类加载器</span>
    <span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token class-name">JdkProxy</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 2.被代理对象实现的所有接口</span>
    <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> clazz <span class="token operator">=</span> userDao<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 3. 使用代理类，进行增强，返回的是代理后的对象</span>
    <span class="token comment">// 第1个参数是当前类的类加载器</span>
    <span class="token comment">// 第2个参数表示的是被代理对象实现的所有接口</span>
    <span class="token comment">// 第3个参数 this 代表的就是代理类 JdkProxy 本身 </span>
    <span class="token keyword">return</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxylnstance</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">,</span> clazz<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * 所有动态代理类的方法调用，都会交由 invoke() 方法去处理
   * proxy   被代理后的对象
   * method  将要被执行的方法信息(反射)
   * args    执行方法时需要的参数
   */</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token class-name">Object</span> invoke <span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token comment">// 声明切面</span>
    <span class="token class-name">MyAspect</span> myAspect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyAspect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token comment">// 前增强</span>
    myAspect<span class="token punctuation">.</span><span class="token function">check_Permissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//在目标类上调用方法，并传入参数</span>
    <span class="token class-name">Object</span> obj <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>userDao<span class="token punctuation">,</span> args<span class="token punctuation">)</span>

    <span class="token comment">// 后增强</span>
    myAspect<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// JdkTest.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>jdk</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdkTest</span> <span class="token punctuation">{</span> 
  pub1ic <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建代理对象</span>
    <span class="token class-name">JdkProxy</span> jdkproxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdkProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建目标对象</span>
    <span class="token class-name">UserDao</span> userDao <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserDaoImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 从代理对象中获取增强后的日标对象</span>
    <span class="token class-name">UserDao</span> userDao1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserDao</span><span class="token punctuation">)</span> jdkProxy<span class="token punctuation">.</span><span class="token function">createProxy</span><span class="token punctuation">(</span>userDao<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token comment">// 执行方法</span>
    userDao1<span class="token punctuation">.</span><span class="token function">addUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    userDao1<span class="token punctuation">.</span><span class="token function">deleteUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="_3-2-spring-的通知类型"><a href="#_3-2-spring-的通知类型" class="header-anchor">#</a> 3.2 Spring 的通知类型</h2> <p>Spring 中的通知按照在目标类方法的连接点位置，可以分为以下 5 种类型。</p> <ul><li><code>org.aopalliance.intercept.MethodInterceptor</code> (环绕通知)<br>
在目标方法执行前后实施增强，可以应用于日志、事务管理等功能。</li> <li><code>org.springframework.aop.MethodBeforeAdvice</code> (前置通知)<br>
在目标方法执行前实施增强，可以应用于权限管理等功能。</li> <li><code>org.springframework.aop.AfterReturningAdvice</code> (后置通知)<br>
在目标方法执行后实施增强，可以应用于关闭流、上传文件、删除临时文件等功能。</li> <li><code>org.springframework.aop.ThrowsAdvice</code> (异常通知)<br>
在方法抛出异常后实施增强，可以应用于处理异常记录日志等功能。</li> <li><code>org.springframework.aop.IntroductionInterceptor</code> (引介通知)<br>
在目标类中添加一些新的方法和属性，可以应用于修改老版本程序(增强类)</li></ul> <h1 id="spring-的数据库开发"><a href="#spring-的数据库开发" class="header-anchor">#</a> Spring 的数据库开发</h1> <h2 id="_4-1-spring-jdbc"><a href="#_4-1-spring-jdbc" class="header-anchor">#</a> 4.1 Spring JDBC</h2> <h3 id="_4-1-1-spring-jdbctemplate-的解析"><a href="#_4-1-1-spring-jdbctemplate-的解析" class="header-anchor">#</a> 4.1.1 Spring jdbcTemplate 的解析</h3> <p>针对数据库的操作， Spring 框架提供了 <code>JdbcTemplate</code> 类，该类是 Spring 框架数据抽象层的基础，其他更高层次的抽象类是构建于 <code>JdbcTemplate</code> 类之上。</p> <p><code>JdbcTemplate</code> 类的继承关系十分简单 它继承自抽象类 <code>JdbcAccessor</code> ，同时实现了 <code>JdbcOperations</code> 接口。从图中可以看出， <code>JdbcTemplate</code> 类的直接父类是 <code>JdbcAccessor</code> ，该类为子类提供了一些访问数据库时使用的公共属性，具体如下：</p> <ul><li><code>DataSource</code>: 其主要功能是获取数据库连接，具体实现时还可以引入对数据库连接的缓冲池和分布式事务的支持，它 <strong>可以作为访问数据库资源的标准接口</strong></li> <li><code>SQLExceptionTranslator</code>: <code>org.springframework.jdbc.support.SQLExceptionTranslator</code> 接口负责对 <code>SQLException</code> 进行转译工作。通过必要的设置或者获取 <code>SQLExceptionTranslator</code> 中的方法，可以使 <code>JdbcTemplate</code> 在需要处理 <code>SQLException</code> 时，委托 <code>SQLExceptionTranslator</code> 的实现类来完成相关的转译工作</li></ul> <p><code>JdbcOperations</code> 接口定义了在 <code>JdbcTemplate</code> 类中可以使用的操作集合，包括添加、修改、查询和删除等操作</p> <img src="../assets/images/java/JdbcTemplate继承关系.jpg" alt="JdbcTemplate继承关系" class="zoom"> <h3 id="_4-1-2-spring-jdbc-的配置"><a href="#_4-1-2-spring-jdbc-的配置" class="header-anchor">#</a> 4.1.2 Spring JDBC 的配置</h3> <p>Spring JDBC 模块主要由 4 个包组成，分别是 core (核心包)、 dataSource (数据源包)、 object (对象包)和 support (支持包)</p> <table><thead><tr><th>包名</th> <th>说明</th></tr></thead> <tbody><tr><td>core</td> <td>包含了 JDBC 的核心功能，包括 JdbcTemplate 类、 SimpleJdbcInsert 类、 SimpleJdbcCall 类以及 NamedParameterJdbcTemplate 类</td></tr> <tr><td>dataSource</td> <td>访问数据源的实用工具类，它有多种数据源的实现，可以在 JavaEE 容器外部测试 JDBC 代码</td></tr> <tr><td>object</td> <td>以面向对象的方式访问数据库，允许执行查询并将返回结果作为业务对象，可以在数据袤的列和业务对象的属性之间映射查询结果</td></tr> <tr><td>support</td> <td>包含了 core 和 object 包的支持类，例如，提供异常转换功能的 SQLException 类</td></tr></tbody></table> <p>Spring 对数据库的操作都封装在了这几个包中，而想要使用 Spring
JDBC ，就需要对其进行配置。在 Spring 中， JDBC 配置是在配置文件 <code>applicationContext.xml</code> 完成的，其配置模板如下：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;l.O&quot; encoding=&quot;UTF-8&quot;?&gt;</span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span> 
      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans 
      http://www.springframework.org/schema/beans/spring-beans-4.3.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 

  <span class="token comment">&lt;!-- 1 配置数据源 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.jdbc.datasource.DriverManagerDataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 
    <span class="token comment">&lt;!-- 数据库驱动 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>driverClassName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.mysql.jdbc.Driver<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 数据库 url --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbc:mysql://localhost:3306/spring<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 数据库用户名 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 数据库密码 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>***<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 2 配置 JDBC 模板 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbcTemplate1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.jdbc.core.JdbcTemplate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 
    <span class="token comment">&lt;!-- 默认必须使用数据源 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
  
  <span class="token comment">&lt;!-- 3 配置注入类 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xxx<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Xxx<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbcTemplate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbcTemplate1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_4-2-jdbctemplate-常用方法"><a href="#_4-2-jdbctemplate-常用方法" class="header-anchor">#</a> 4.2 JdbcTemplate 常用方法</h2> <p>JdbcTemplate 类中，提供了大量的更新和查询数据库的方法，我们就是使用这些方法来操
作数据库的。</p> <ol><li><strong><code>execute()</code> 执行 SQL 语句</strong></li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// JdbcTemplateTest.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>jdbc</span><span class="token punctuation">;</span> 

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ApplicationContext</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">JdbcTemplate</span><span class="token punctuation">;</span> 

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcTemplateTest</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 
  * 使用 execute() 方法建表
  */</span> 
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 加载配置文件</span>
    <span class="token class-name">ApplicationContext</span> applicationContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token string">&quot;applicationContext.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// 获取 JdbcTemplate 实例</span>
    <span class="token class-name">JdbcTemplate</span> jdTemplate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">JdbcTemplate</span><span class="token punctuation">)</span> applicationContext<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;jdbcTemplate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token comment">// 使川 execute() 方法执行 SQL 语句，创建用户账户管理表 account</span>
    jdTemplate<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token string">&quot;create table account(&quot;</span> <span class="token operator">+</span> 
                       <span class="token string">&quot;id int primary key auto_increment,&quot;</span> <span class="token operator">+</span> 
                       <span class="token string">&quot;usernæ varchar(50),&quot;</span> <span class="token operator">+</span> 
                       <span class="token string">&quot;balance double)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;账户表 account 创建成功!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ol start="2"><li><strong><code>update()</code> 插入/更新/删除数据操作</strong></li></ol> <table><thead><tr><th>方法</th> <th>说明</th></tr></thead> <tbody><tr><td><code>int update(String sql)</code></td> <td>该方法直接执行传入的 SQL 语句，并返回受影响的行数</td></tr> <tr><td><code>int update(PreparedStatementCreator psc)</code></td> <td>该方法执行从 <code>PreparedStatementCreator</code> 返回的语句，然后返回受影响的行数</td></tr> <tr><td><code>int update(String sql, PreparedStatementSetter pss)</code></td> <td>该方法通过 <code>PreparedStatementSetter</code> 设置 SQL 语句中的参数，并返回受影响的行数</td></tr> <tr><td><code>int update(String sql, Object... args)</code></td> <td>该方法使用 <code>Object...</code> 设置 SQL 语句中的参数，要求参数不能为 <code>NULL</code> ，并返回受影响的行数</td></tr></tbody></table> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token comment">// AccountDaolmpl.java</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>jdbc</span> <span class="token punctuation">;</span> 

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">JdbcTemplate</span><span class="token punctuation">;</span> 

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountDaolmpl</span> <span class="token keyword">implements</span> <span class="token class-name">AccountDao</span> <span class="token punctuation">{</span>
  <span class="token comment">// 声明 JdbcTemplate 属性及其 setter 方法</span>
  <span class="token keyword">private</span> <span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">;</span> 
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setJdbcTemplate</span><span class="token punctuation">(</span><span class="token class-name">JdbcTemplate</span> jdbcTemplate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcTemplate <span class="token operator">=</span> jdbcTemplate<span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>

  <span class="token comment">// 添加账户</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">addAccount</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 定义 SQL</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into account(username, balance) value(?, ?)&quot;</span><span class="token punctuation">;</span> 
    <span class="token comment">// 定义数组存储 SQL 语句中的参数</span>
    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
      account<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
      account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 执行添加操作，返回的是受 SQL 语句影响的记录条数</span>
    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token keyword">return</span> num<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 更新账户</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updateAccount</span><span class="token punctuation">(</span><span class="token class-name">Account</span> account <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 定义 SQL</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;update account set username=?, balance=? where id = ?&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 定义数组存储 SQL 语句中的参数</span>
    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
      account<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
      account<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      account<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 执行更新操作，返回的是受 SQL 语句影响的记录条数</span>
    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token keyword">return</span> num<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 删除账户</span>
  <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deleteAccount</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 定义 SQL</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;delete from account where id = ?&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 执行删除操作，返回的是受 SQL 语句影响的记录条数</span>
    <span class="token keyword">int</span> num is<span class="token punctuation">.</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token keyword">return</span> num<span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><ol start="3"><li><strong><code>query()</code> 数据库表查询操作</strong></li></ol> <table><thead><tr><th>方法</th> <th>说明</th></tr></thead> <tbody><tr><td><code>List query(String sql, RowMapper rowMapper)</code></td> <td>执行 String 类型参数提供的 SQL 语句，并通过 <code>RowMapper</code> 返回一个 List 类型的结果</td></tr> <tr><td><code>List query (String sql, PreparedStatementSetter pss, RowMapper rowMapper )</code></td> <td>根据 String 类型参数提供的 SQL 语句创建 <code>PreparedStatement</code> 对象，通过 <code>RowMapper</code> 将结果返回到 List</td></tr> <tr><td><code>List query (String sql, Object[] args, RowMapper rowMapper)</code></td> <td>使用 Object口的值来设置 SQL 语句中的参数值，采用 <code>RowMapper</code> 回调方法可以直接返回 List 类型的数据</td></tr> <tr><td><code>queryForObject(String sql, RowMapper rowMapper, Object... args)</code></td> <td>将 args 参数绑定到 SQL 语句中，并通过 <code>RowMapper</code> 返回一个 Object 类型的单行记录</td></tr> <tr><td><code>queryForList(String sql, Object[] args, class&lt;T&gt; elementType)</code></td> <td>该方法可以返回多行数据的结果，但必须是返回列表， <code>elementType</code> 参数返回的是 List 元素类型</td></tr></tbody></table> <h1 id="spring-的事务管理"><a href="#spring-的事务管理" class="header-anchor">#</a> Spring 的事务管理</h1> <p>操作数据库时还会涉及事务管理问题，为此 Spring 提供了专门用于事务处理的 API 。</p> <h2 id="_5-1-spring-事务管理概述"><a href="#_5-1-spring-事务管理概述" class="header-anchor">#</a> 5.1 Spring 事务管理概述</h2> <h3 id="_5-1-1-核心接口"><a href="#_5-1-1-核心接口" class="header-anchor">#</a> 5.1.1 核心接口</h3> <p>在 Spring 的所有 JAR 包中，包含一个名为 <code>spring-tx-4.3.6.RELEASE</code> 的 JAR 包，该包就是 Spring 提供的用于事务管理的依赖包。在该 JAR 包的 org.springframework.transaction 包中，包含 3 个 Spring 事务管理的 核心接口文件 PlatformTransactionManager 、 TransactionDefinition 和 TransactionStatus 。</p> <ol><li><strong>PlatformTransactionManager</strong></li></ol> <p>PlatformTransactionManager 接口是平台事务管理器，主要用于管理事务。该接口中提供了 3 个事务操作的方法：</p> <ul><li><code>TransactionStatus getTransaction(TransactionDefinition definition)</code> 用于获取事务状态信息</li> <li><code>void commit(TransactionStatus status)</code> 用于提交事务</li> <li><code>void rollback(TransactionStatus status)</code> 用于回滚事务</li></ul> <ol start="2"><li><strong>TransactionDefinition</strong></li></ol> <p>TransactionDefinition 接口是事务定义(描述)的对象，该对象中定义了事务规则，并提供了获取事务相关信息的方法。</p> <ul><li><code>String getName()</code> 获取事务对象名称</li> <li><code>int getlsolationLevel()</code> 获取事务的隔离级别</li> <li><code>int getPropagationBehavior()</code> 获取事务的传播行为</li> <li><code>int getTimeout()</code> 获取事务的超时时间</li> <li><code>boolean isReadOnly()</code> 获取事务是否只读</li></ul> <ol start="3"><li><strong>TransactionStatus</strong></li></ol> <p>TransactionStatus 接口是事务的状态，它描述了某一时间点上事务的状态信息。该接口中包含 6 个方法。</p> <ul><li><code>void flush()</code> 刷新事务</li> <li><code>boolean hasSavepoint()</code> 获取是否存在保存点</li> <li><code>boolean isCompleted()</code> 获取事务是否完成</li> <li><code>boolean isNewTransaction()</code> 获取是否是新事务</li> <li><code>boolean isRollbackOnly()</code> 获取是否回滚</li> <li><code>void setRollbackOnly()</code> 设置事务回滚</li></ul> <h3 id="_5-1-2-事务管理的方式"><a href="#_5-1-2-事务管理的方式" class="header-anchor">#</a> 5.1.2 事务管理的方式</h3> <p>Spring 中的事务管理分为两种方式：一种是传统的编程式事务管理，另一种是声明式事务管理</p> <ul><li><strong>编程式事务管理</strong> ：是通过编写代码实现的事务管理，包括定义事务的开始、正常执行后的
事务提交和异常时的事务回滚</li> <li><strong>声明式事务管理</strong> ：是通过 AOP 技术实现的事务管理，其主要思想是 <strong>将事务管理作为一个“切面”代码单独编写</strong> ，然后通过 AOP 技术将事务管理的“切面”代码织入到业务目标类中</li></ul> <p>在实际开发中，通常都推荐使用声明式事务管理，其最大的优点在于开发者无须通过编程的方式来管理事务，只需在配置文件中进行相关的事务规则声明，就可以将事务规则应用到业务逻辑中。</p> <h2 id="_5-2-声明式事务管理"><a href="#_5-2-声明式事务管理" class="header-anchor">#</a> 5.2 声明式事务管理</h2> <p>Spring 的声明式事务管理可以通过两种方式来实现，一种是基于 XML 的方式，另一种是基于 Annotation 的方式。</p> <h3 id="_5-2-1-基于-xml-方式的声明或事务"><a href="#_5-2-1-基于-xml-方式的声明或事务" class="header-anchor">#</a> 5.2.1 基于 XML 方式的声明或事务</h3> <p>基于 XML 方式的声明式事务管理是通过在配置文件中配置事务规则的相关声明来实现的。Spring 以后，提供了 tx 命名空间来配置事务， tx 命名空间下提供了 <code>&lt;tx:advice&gt;</code> 元素来配置
事务的通知(增强处理) 当使用 <code>&lt;tx:advice&gt;</code> 元素配置了事务的增强处理后，就可以通过编写的 AOP 配置，让 Spring 自动对目标生成代理。</p> <p>配置 <code>&lt;tx:advice&gt;</code> 元素时，通常需要指定 <code>id</code> 和 <code>transaction-manager</code> 属性，其中 <code>id</code> 属性是配置文件中的唯一标识， <code>transaction-manager</code> 属性用于指定事务管理器。除此之外，还需要配置一个 <code>&lt;tx:attributes&gt;</code> 子元素，该子元素可通过配置多个 <code>&lt;tx:method&gt;</code> 子元素来配置执行事务的细节。</p> <h3 id="_5-2-2-基于-annotation-方式的声明式事务"><a href="#_5-2-2-基于-annotation-方式的声明式事务" class="header-anchor">#</a> 5.2.2 基于 Annotation 方式的声明式事务</h3> <p>该方式比较简单，只需要两步：</p> <ol><li>在 Spring 容器中注册事务注解驱动，其代码如下</li></ol> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/ &gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>在需要使用事务的 Spring Bean 类或者 Bean 类的方法上添加注解 <code>@Transactional</code> 。如果
将注解添加在 Bean 类上，则表示事务的设置对整个 Bean 类的所有方法都起作用；如果将注解
添加在 Bean 类中的某个方法上，则表示事务的设置只对该方法有效。</li></ol> <p>使用 <code>@Transactional</code> 注解时，可以通过其参数配置事务详情。 <code>@Transactional</code> 注解可配置的数信息如下表：</p> <table><thead><tr><th>参数名称</th> <th>描述</th></tr></thead> <tbody><tr><td><code>value</code></td> <td>用于指定要使用的事务管理器，默认为&quot;&quot;，其别名为 transactionManager</td></tr> <tr><td><code>transactionManager</code></td> <td>指定事务的限定符值，可用于确定目标事务管理器，匹配特定的限定值(或者 Bean 的 name 值) ，默认为&quot;&quot;，其别名为 value</td></tr> <tr><td><code>isolation</code></td> <td>用于指定事务的隔离级别，默认为 <code>Isolation.DEFAULT</code> (即底层事务的隔离级别)</td></tr> <tr><td><code>noRollbackFor</code></td> <td>用于指定遇到特定异常时强制不回滚事务</td></tr> <tr><td><code>noRollbackForClassName</code></td> <td>用于指定遇到特定的多个异常时强制不回滚事务，其属性值可以指定多个异常类名</td></tr> <tr><td><code>propagation</code></td> <td>用于指定事务的传播行为，默认为 <code>Propagation.REQUIRED</code></td></tr> <tr><td><code>read-only</code></td> <td>用于指定事务是否只读，默认为 <code>false</code></td></tr> <tr><td><code>rollbackFor</code></td> <td>用于指定遇到特定异常时强制回滚事务</td></tr> <tr><td><code>rollbackForClassName</code></td> <td>用于指定遇到特定的多个异常时强制回滚事务。其属性值可以指定多个异常类</td></tr> <tr><td><code>timeout</code></td> <td>用于指定事务的超时时长，默认为 <code>TransactionDefinition.TIMEOUT_DEFAULT</code> (即底层事务系统的默认时间)</td></tr></tbody></table> <p>示例：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- applicationContaxt-annotation.xml --&gt;</span>
<span class="token prolog">&lt;?xml version=&quot;1. 0&quot; encoding=&quot;UTF-8 &quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>aop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/aop<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name"><span class="token namespace">xmlns:</span>tx</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/tx<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/context<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans
      http://www.springframework.org/schema/beans/spring-beans-4.3.xsd
      http://www.springframework.org/schema/tx
      http://www.springframework.org/schema/tx/spring-tx-4.3.xsd
      http://www.springframework.org/schema/context 
      http://www.springframework.org/schema/context/spring-context-4.3.xsd
      http://www.springframework.org/schema/aop
      http://www.springframework.org/schema/aop/spring-aop-4.3.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 

  <span class="token comment">&lt;!-- 1. 配置数据源 --&gt;</span>

  <span class="token comment">&lt;!-- 2. 配置 JDBC 模板 --&gt;</span>

  <span class="token comment">&lt;!-- 3. 定义 id 为 accountDao 的 Bean --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>accountDao<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.itheima.jdbc.AccountDaoImpl<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 将 jdbcTemplate 注入到 AccountDao 实例中 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbcTemplate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jdbcTemplate1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 4. 事务管理器，依赖于数据源 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> transactionManager <span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.jdbc.datasource. DataSourceTransactionManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dataSource<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 5. 注册事务管理器驱动 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">tx:</span>annotation-driven</span> <span class="token attr-name">transaction-manager</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>transactionManager<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 在 AccountDaoImpl 类的 transfer() 方法上添加事务注解</span>

  <span class="token comment">/**
    需要注意的是，使用了注解式开发，则需要在配置文件中开启注解处理器，指定扫描哪些包下的注解。
    这里没有开启注解处器是因为在配置文件中已经配置了 AccountDaoImpl 类的 Bean ，而 
    @Transactional 注解就配置在该 Bean 类中，所以可以直接生效
   */</span>
  <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>propagation<span class="token operator">=</span><span class="token class-name">Propagation<span class="token punctuation">.</span>REQUlRED</span><span class="token punctuation">,</span> isolation<span class="token operator">=</span><span class="token class-name">Isolation</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">,</span> raadOnly <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> 
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">String</span> outUser<span class="token punctuation">,</span> <span class="token class-name">String</span> inUser<span class="token punctuation">,</span> <span class="token class-name">Double</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 收款时，收款用户的余额 = 现有余额 + 所汇金额</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&quot;update account set balance = balance +?&quot;</span>
                    <span class="token operator">+</span> <span class="token string">&quot;where username = ?&quot;</span><span class="token punctuation">,</span> money<span class="token punctuation">,</span> inUser<span class="token punctuation">)</span> <span class="token punctuation">;</span> 
    <span class="token comment">// 模拟系统运行时的突发性问题</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">0</span> <span class="token punctuation">;</span> 
    <span class="token comment">// 汇款时，汇款用户的余额 = 现有余额 - 所汇金额</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>jdbcTemplate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">&quot;update account set balance = balance-? &quot;</span> 
                    <span class="token operator">+</span> <span class="token string">&quot;where username = ?&quot;</span><span class="token punctuation">,</span> money<span class="token punctuation">,</span> outUser<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h1 id="mybatis"><a href="#mybatis" class="header-anchor">#</a> MyBatis</h1> <p>MyBatis 是当前主流的 Java 持久层框架之一，它与 Hibernate 一样，也是一种 ORM 框架因其性能优异，且具有高度的灵活性、可优化性和易于维护等特点，所以受到了广大互联网企业的青睐，是目前大型互联网项目的首选框架。</p> <h2 id="_6-1-mybatis-简述"><a href="#_6-1-mybatis-简述" class="header-anchor">#</a> 6.1 MyBatis 简述</h2> <p>MyBatis （前身是 iBatis）是一个支持普通 SQL 查询、存储过程以及高级映射的持久层框架，它消除了几乎所有的 JDBC 代码和参数的手动设置以及对结果集的检索，并使用简单的 XML 注解进行配置和原始映射，用以将接口和 Java POJO （Plain Old Java Object ，普通 Java 对象）映射成数据库中的记录，使得 Java 开发人员可以使用面向对象的编程思想来操作数据库。</p> <img src="../assets/images/java/ORM框架的工作原理.jpg" alt="ORM框架的工作原理" class="zoom"> <p>MyBatis 框架也被称之为 ORM （Object/Relational Mapping ，即对象关系映射）框架。所谓的 ORM 就是一种为了解决面向对象与关系型数据库中数据类型不匹配的技术，它通过描述
Java 对象与数据库表之间的映射关系，自动将 Java 应用程序中的对象持久化到关系型数据库的
表中。</p> <h2 id="_6-2-mybatis-的工作原理"><a href="#_6-2-mybatis-的工作原理" class="header-anchor">#</a> 6.2 MyBatis 的工作原理</h2> <img src="../assets/images/java/MyBatis框架执行流程图.jpg" alt="MyBatis框架执行流程图" class="zoom"> <h2 id="_6-3-spring-与-mybatis-的整合"><a href="#_6-3-spring-与-mybatis-的整合" class="header-anchor">#</a> 6.3 Spring 与 MyBatis 的整合</h2> <h1 id="spring-mvc"><a href="#spring-mvc" class="header-anchor">#</a> Spring MVC</h1> <h2 id="工作流程"><a href="#工作流程" class="header-anchor">#</a> 工作流程</h2> <img src="../assets/images/java/SpringMVC工作原理.jpg" alt="SpringMVC工作原理" class="zoom"> <p>如上图所示，</p> <ul><li>① 用户通过浏览器向服务器发送请求，请求会被 Spring MVC 的前端控制器 <code>DispatcherServlet</code> 所拦截</li> <li>② <code>DispatcherServlet</code> 拦截到请求后，会调用 HandlerMapping 处理器映射器</li> <li>③ 处理器映射器根据请求 URL 找到具体的处理器，生成处理器对象及处理器拦截器（如果有则生成）一并返回给 <code>DispatcherServlet</code></li> <li>④ <code>DispatcherServlet</code> 会通过返回信息选择合适的 HandlerAdapter （处理器适配器）</li> <li>⑤ HandlerAdapter 会调用并执行 Handler (处理器)，这里的处理器指的就是程序中编写的 <code>Controller</code> 类，也被称之为 <strong>后端控制器</strong></li> <li>⑥ <code>Controller</code> 执行完成后，会返回一个 <code>ModelAndView</code> 对象，该对象中会包含视图名或包含模型和视图名</li> <li>⑦ HandlerAdapter  将 <code>ModelAndView</code> 对象返回给 <code>DispatcherServlet</code></li> <li>⑧ <code>DispatcherServlet</code> 会根据 <code>ModelAndView</code> 对象选择一个合适的 ViewReslover （视图解析器）</li> <li>⑨ ViewReslover 解析后，会向 <code>DispatcherServlet</code> 中返回具体的 View （视图）</li> <li>⑩ <code>DispatcherServlet</code> 对 View 进行渲染（即将模型数据填充至视图中）</li> <li>⑪ 视图渲染结果返回给客户端浏览器显示</li></ul> <p>在上述执行过程中， DispatcherServlet 、 HandlerMapping 、 HandlerAdapter 、 ViewResolver对象的工作是在框架内部执行的，开发人员并不需要关心这些对象内部的实现过程， <strong>只需要配置前端控制器（DispatcherServlet），完成 Controller 中的业务处理，并在视图中（View)）中展示相应信息即可</strong> 。</p> <h2 id="spring-mvc-相关注解"><a href="#spring-mvc-相关注解" class="header-anchor">#</a> Spring MVC 相关注解</h2> <h3 id="controller-注解类型"><a href="#controller-注解类型" class="header-anchor">#</a> <code>@Controller</code> 注解类型</h3> <p>该注解位于 <code>org.springframework.stereotype.Controller</code> ， <strong>指示 Spring 类的实例是一个控制器</strong> 。该注解在使用时不需要再实现 Controller 接口，只需要将 <code>@Controller</code> 注解加入到控制器类上，然后通过 Spring 的扫描机制找到标注了该注解的控制器即可。基于注解的控制器可以同时处理多个请求动作，在使用上更加的灵活。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span> 

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span><span class="token punctuation">;</span> 

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FirstController</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="requestmapping-注解类型"><a href="#requestmapping-注解类型" class="header-anchor">#</a> <code>@RequestMapping</code> 注解类型</h3> <p>Spring 通过 <code>@Controller</code> 注解找到相应的控制器类后，还需要知道控制器内部对每一个请求是如何处理的，这就需要使用。org.springframework.web.bind.annotation.RequestMapping 注解类型。  RequestMapping 注解类型用于映射一个请求或一个方法，其注解形式为 <code>@RequestMapping</code> ，可以使用该注解 <strong>标注在一个方法或一个类上</strong> 。</p> <ol><li><strong>标注在方法上</strong></li></ol> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span> 

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FirstController</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/firstController&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> mav<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>使用 <code>@RequestMapping</code> 注解后，上述代码中的 <code>handleRequest()</code> 方法就可以通过地址 <u>http//localhost:8080/.../firstController</u> 进行访问。</p> <ol start="2"><li><strong>标注在类上</strong></li></ol> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span> 

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FirstController</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;/firstController&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">handleRequest</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">return</span> mav<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>由于在类上添加了 RequestMapping 注解，所以上述代码方法的请求路径将变为 <u>http//localhost:8080/.../hello/firstController</u>。</p> <h3 id="组合注解"><a href="#组合注解" class="header-anchor">#</a> 组合注解</h3> <p>在 Spring 框架 4.3 版本中，引入了组合注解，来帮助简化常用的 HTIP 方法的映射，并更好地表达被注解方法的语义。</p> <ul><li><code>@GetMapping</code>: 匹配 GET 方式的请求，相当于 <code>@RequestMapping(method=RequestMethod.GET)</code></li> <li><code>@PostMapping</code>: 匹配 POST 方式的请求</li> <li><code>@PutMapping</code>: 匹配 PUT 方式的请求</li> <li><code>@DeleteMapping</code>: 匹配 DELETE 方式的请求</li> <li><code>@PatchMapping</code>: 匹配 PATCH 方式的请求</li></ul> <h2 id="数据绑定"><a href="#数据绑定" class="header-anchor">#</a> 数据绑定</h2> <p>在执行程序时， Spring MVC 会根据客户端请求参数的不同，将请求消息中的信息以一定的方式转换并绑定到控制器类的方法参数中。这种 <strong>将请求消息数据与后台方法参数建立连接的过程就是 Spring MVC 中的数据绑定</strong> 。</p> <p>在数据绑定过程中， Spring MVC 框架会通过数据绑定组件（DataBinder）将请求参数串的内容进行类型转换，然后将转换后的值赋给控制器类中方法的形参，这样后台方法就可以正确绑定并获取客户端请求携带的参数了。</p> <img src="../assets/images/java/SpringMVC数据绑定的过程.jpg" alt="SpringMVC数据绑定的过程" class="zoom"> <p>关于上图中信息处理过程的步骤描述如下</p> <ul><li>① Spring MVC 将 ServletRequest 对象传递给 DataBinder</li> <li>② 将处理方法的入参对象传递给 DataBinder</li> <li>③ DataBinder 调用 ConversionService 组件进行数据类型转换、数据格式化等工作，并将 ServletRequest 对象中的消息填充到参数对象中</li> <li>④ 调用 Validator 组件对已经绑定了请求消息数据的参数对象进行数据合法性校验</li> <li>⑤ 校验完成后会生成数据绑定结果 BindingResult 对象， Spring MVC 会将 BindingResult 对象中的内容赋给处理方法的相应参数</li></ul> <p>根据客户端请求参数类型和个数的不同，我们将 Spring MVC 中的数据绑定主要分为简单数据绑定和复杂数据绑定。</p> <h3 id="简单数据绑定"><a href="#简单数据绑定" class="header-anchor">#</a> 简单数据绑定</h3> <ol><li><strong>绑定默认数据类型</strong></li></ol> <table><thead><tr><th>默认参数类型</th> <th>说明</th></tr></thead> <tbody><tr><td>HttpServletRequest</td> <td>通过 request 对象获取请求信息</td></tr> <tr><td>HttpServletResponse</td> <td>通过 response 处理响应信息</td></tr> <tr><td>HttpSession</td> <td>通过 session 对象得到 session 中存储的对象</td></tr> <tr><td>Model/ModelMap</td> <td>Model 是一个接口， ModelMap 是一个接口实现，作用是将 model 数据填充到 request</td></tr></tbody></table> <p>以 HttpServletRequest 为例：</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token comment">// UserController.java</span>
<span class="token keyword">package</span> <span class="token namespace">com</span> <span class="token punctuation">.</span> itheima <span class="token punctuation">.</span> contro11er<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>serv1et<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/selectUser&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> id <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;id=&quot;</span><span class="token operator">+</span>id<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;/WEB-INF/jsp/success.jsp&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>当我们访问地址 <u>http://localhost:8080/.../selectUser?id=1</u> ，便可以获取到请求传入的参数 <code>id</code> 。</p> <ol start="2"><li><strong>绑定简单数据类型</strong></li></ol> <p>当我把上面的代码改成如下形式，再次访问地址 <u>http://localhost:8080/.../selectUser?id=1</u> ，同样是有效的：</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/selectUser&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">selectUser</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;id=&quot;</span><span class="token operator">+</span>id<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;/WEB-INF/jsp/success.jsp&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>需要注意的是，有时候前端请求中参数名（如改成 <code>?id1=1</code> ）和后台控制器类方法中的形参名（如改成 <code>Integer id2</code> ）不一样，这就会导致后台无法正确绑定并接收到前端请求的参数，此时可以使用注解 <code>@RequestParam</code> 间接数据绑定（如改成 <code>selectUser(@RequestParam(value=&quot;id1&quot;) Integer id2)</code> ）。</p> <p>该注解的 4 个属性如下表：</p> <table><thead><tr><th>属性</th> <th>说明</th></tr></thead> <tbody><tr><td><code>value</code></td> <td>name 属性的别名，这里指参数的名字，即入参的请求参数名字，如 value=&quot;item_id&quot; 表示请求的参数中名字为 item id 的参数的值将传入。如果只使用 vaule 属性，则可以省略 value 属性名</td></tr> <tr><td><code>name</code></td> <td>指定请求头绑定的名称</td></tr> <tr><td><code>required</code></td> <td>用于指定参数是否必须，默认是 <code>true</code></td></tr> <tr><td><code>defaultValue</code></td> <td>请求的默认值</td></tr></tbody></table> <ol start="3"><li><strong>绑定 POJO 类型</strong></li></ol> <p>POJO 类型的数据绑定就是将所有关联的请求参数封装在一个 POJO 中，然后在方法中直接使用该 POJO 作为形参来完成数据绑定。</p> <p><strong>💡 用户注册示例</strong></p> <p>➰ User.java</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>po</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 用户 POJO 类
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>       <span class="token comment">// 用户 id</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>  <span class="token comment">// 用户</span>
  <span class="token keyword">private</span> <span class="token class-name">Integer</span> password<span class="token punctuation">;</span> <span class="token comment">// 用户密码</span>

  <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> id<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> username<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> password<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>➰ UserController.java</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token comment">/**
   * 向用户注册页面跳转
   */</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/toRegister&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toRegister</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;register&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * 接收用户注册信息
   */</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/registerUser&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">registerUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> userame <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> 
    <span class="token class-name">Integer</span> password <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;username=&quot;</span><span class="token operator">+</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;password=&quot;</span><span class="token operator">+</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>➰ register.jsp</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>&lt;%@ page language=&quot;java&quot; conteηtType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot; %&gt;

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html; charset=UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>注册<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${pageContext.request.contextPath}/registerUser<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      用户名: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span>
      密码: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/&gt;</span></span> 
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">va1ue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>注册<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">DANGER</p> <p>在使用 POJO 类型数据绑定时，前端请求的参数名（本例中指 form 表单内各元素的 name 属性值）必须与要绑定的 POJO 类中的属性名一样，这样才会自动将请求数据绑定到 POJO 对象中，否则后台接收的参数值为 <code>null</code></p></div> <p>为了防止前端传入的中文数据出现乱码问题，我们可以使用 Spring 提供的编码过滤器来统一编码。要使用编码过滤器，只需要在 web.xml 中添加如下代码。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 配置编码过滤器 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fi1ter-name</span><span class="token punctuation">&gt;</span></span>CharacterEncodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>
    org.springframework.web.filter.CharacterEncodingFilter
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>encoding<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>CharacterEncodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>上述代码中，通过 <code>&lt;filter-mapping&gt;</code> 元素的配置会拦截前端页面中的所有请求，并交由名称 CharacterEncodingFilter 的编码过滤器类进行处理 filter 元素中，首先配置了编码过滤器类 <code>org.springfamework.web.filter.CharacterEncodingFilter</code> ，然后通过初始化参数设置统一的编码为 UTF-8 。这样所有的请求信息内容都会以 UTF-8 的编码格式进行解析。</p> <h3 id="复杂数据绑定"><a href="#复杂数据绑定" class="header-anchor">#</a> 复杂数据绑定</h3> <p>可能遇到一些比较复杂的数据绑定问题，比如数组的绑定 、集合的绑定，这在实际开发中也是十分常见的。</p> <ol><li><strong>绑定数组</strong></li></ol> <p>在实际开发时，可能会遇到前端请求需要传递到后台一个或多个相同名称参数的情况（如批量删除），此种情况采用前面讲解的简单数据绑定的方式显然是不合适的 此时，就可以使用绑定数组的方式。</p> <p><strong>💡 批量删除用户示例</strong></p> <p>➰ user.jsp</p> <div class="language-html line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-html"><code>&lt;%@ page language=&quot;java&quot; conteηtType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot; %&gt;

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html; charset=UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>用户列表<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${pageContext.request.contextPath}/deleteUsers<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>选择<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ids<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>l<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>tom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ids<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>jack<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ids<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>lucy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">va1ue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>删除<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>➰ UserController.java</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token comment">/**
   * 向用户列表页面跳转
   */</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/toUser&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">selectUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * 接收批量删除用户的方法
   */</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/deleteUsers&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">deleteUsers</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ids <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Integer</span> id <span class="token operator">:</span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;删除了 id 为&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span> <span class="token string">&quot;的用户！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ids 为 null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ol start="2"><li><strong>绑定集合</strong></li></ol> <p><strong>💡 批量修改用户示例</strong></p> <p>➰ UserVO.java</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>po<span class="token punctuation">.</span></span><span class="token class-name">User</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 用户包装类
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserVO</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> users<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsers</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>users <span class="token operator">=</span> users<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>➰ UserController.java</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token comment">/**
   * 向用户批量修改页面跳转
   */</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/toUserEdit&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">selectUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;user_edit&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * 接收批量修改用户的方法
   */</span>
  <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/editUsers&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">editUsers</span><span class="token punctuation">(</span><span class="token class-name">UserVO</span> userList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> userList<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">User</span> user <span class="token operator">:</span> users<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> 
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>➰ user_edit.jsp</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>&lt;%@ page language=&quot;java&quot; conteηtType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot; %&gt;

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Content-Type<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html; charset=UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>修改列表<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${pageContext.request.contextPath}/editUsers<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>formid<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>选择<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span>用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>users[0].id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>l<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>users[0].username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tome<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>users[1].id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>users[1].username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jack<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">va1ue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>修改<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h1 id="spring-拦截器"><a href="#spring-拦截器" class="header-anchor">#</a> Spring 拦截器</h1> <h2 id="拦截器概述"><a href="#拦截器概述" class="header-anchor">#</a> 拦截器概述</h2> <p>Spring MVC 中的拦截器（Interceptor）类似于 Servlet 中的过滤器（Filter），它主要用于拦截用户请求并做相应的处理。例如通过拦截器可以进行权限验证、记录请求信息的日志、判断用户是否登录等。</p> <p>要使用 Spring MVC 中的拦截器，就需要对拦截器类进行定义和配置。通常拦截器类可以通过两种方式来定义。 <strong>一种</strong> 是通过实现 HandlerInterceptor 接口，或继承 HandlerInterceptor 接口的实现类（如 HandlerInterceptorAdapter）来定义； <strong>另一种</strong> 是通过实现 WebRequestInterceptor 接口，或继承 WebRequestInterceptor 接口的实现类来定义。</p> <p>以第一种为例，代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">BandlerInterceptor</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
      <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
    该方法会在控制器方法前执行，其返回值表示是否中断后续操作。
    当其返回值为 true 时，表示继续向下执行；
    当其返回值为 false 时，会中断后续的所有操作(包括调用下一个拦截器和控制器类中的方法执行等)
     */</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postBandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
      <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span>
      <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">/** 
    该方法会在控制器方法调用之后，且解析视图之前执行。
    可以通过此方法对请求域中的模型和视图做出进一步的修改
     */</span>
    <span class="token comment">// ... </span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
      <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span>
      <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
    该方法会在整个请求完成，即视图渲染结束之后执行。
    可以通过此方法实现一些资源清理、记录日志信息等工作。
     */</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>然后，要使自定义的拦截器类生效，还需要在 Spring MVC 的配置文件中进行配置。</p> <div class="language-xml line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-xml"><code><span class="token comment">&lt;!-- 配置拦截器 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>interceptors</span><span class="token punctuation">&gt;</span></span> 
  
  <span class="token comment">&lt;!-- 全局拦截器 --&gt;</span>

  <span class="token comment">&lt;!-- 使用 bean 直接定义在 &lt;mvc:interceptors&gt; 下面的 Interceptor 将拦截所有请求 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.itheima.interceptor.CustomInterceptor<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
  
  <span class="token comment">&lt;!-- 指定路径拦截器 --&gt;</span>

  <span class="token comment">&lt;!-- 拦截器1 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>interceptor</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 配置拦截器作用的路径 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>mapping</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/**<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 配置不需要拦截器作用的路径 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>exclude-mapping</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 定义在 &lt;mvc:interceptor&gt; 下面的，表示对匹配路径的请求才进行拦截 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.itheima.interceptor.Interceptor1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">mvc:</span>interceptor</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 拦截器2 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>interceptor</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>mapping</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/hello<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.itheima.interceptor.Interceptor2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">mvc:</span>interceptor</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">mvc:</span>interceptors</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.04d1c14b.js" defer></script><script src="/blog/assets/js/2.37055818.js" defer></script><script src="/blog/assets/js/33.7d1040a5.js" defer></script>
  </body>
</html>
